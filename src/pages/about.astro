---
import ImageMod from "@/components/ImageMod.astro";
import Base from "@/layouts/Base.astro";
import PageHeader from "@/partials/PageHeader.astro";
import { markdownify } from "@/lib/utils/textConverter";

const title = "About Us";
const description = "Discover our journey, expertise, and commitment to innovation.";
const image = "/images/team-photo.jpg";

// Stats
const stats = [
  { target: 107, label: "Projects Completed" },
  { target: 32, label: "Clients Served" },
  { target: 8, label: "Years of Experience" }
];

// Timeline items
const timelineItems = [
  {
    year: "2018",
    title: "The Beginning",
    description: "We started as a small, ambitious team passionate about building intelligent software. Our first project, <strong>DataFusion</strong> ğŸŒ, was a data aggregation tool that streamlined information from multiple sources.",
    icon: "ğŸŒ±"
  },
  {
    year: "2019",
    title: "Breaking Boundaries",
    description: "We developed <strong>InsightIQ</strong> ğŸ“Š, an AI-driven analytics platform providing real-time insights for data-driven decisions.",
    icon: "ğŸŒ"
  },
  {
    year: "2020",
    title: "AI Breakthrough",
    description: "We made a significant impact with <strong>AutoFlow</strong> ğŸ¤–, an AI-powered workflow automation tool, increasing productivity by up to 40%.",
    icon: "ğŸ’¡"
  },
  {
    year: "2021",
    title: "Industry Integration",
    description: "Launched <strong>SmartNet</strong> ğŸŒ, an IoT integration platform for smart infrastructure projects in healthcare and logistics.",
    icon: "ğŸ”—"
  },
  {
    year: "2022",
    title: "Blockchain Integration",
    description: "Introduced <strong>CryptoGuard</strong> ğŸ’°, a secure asset management tool offering real-time tracking and fraud detection.",
    icon: "ğŸ”"
  },
  {
    year: "2023",
    title: "Scaling Up",
    description: "Launched <strong>Flux360</strong> ğŸš€, expanding globally and serving clients in healthcare, fintech, and supply chain management.",
    icon: "ğŸ†"
  },
  {
    year: "2024",
    title: "Strategic Partnerships",
    description: "Forged key partnerships with leading tech companies to enhance our AI and blockchain capabilities.",
    icon: "ğŸŒ"
  },
  {
    year: "2025",
    title: "Innovation Hub",
    description: "Established the <strong>Flux Innovation Hub</strong>, focusing on developing next-gen solutions in AI, blockchain, and automation.",
    icon: "ğŸš€"
  }
];
---

<Base title={title} description={description}>
  <PageHeader title={title} />

  <!-- About Section -->
  <section class="section-sm bg-body dark:bg-darkmode-body text-text-dark dark:text-darkmode-text-dark">
    <div class="container">
      <div class="row justify-center">
        <div class="text-center md:col-10 lg:col-7">
          <h2 class="h3 mb-6 text-primary dark:text-darkmode-primary">Who We Are</h2>
          <p class="text-lg text-text-light dark:text-darkmode-text-light">
            {markdownify("FluxFloats is a forward-thinking software house specializing in Artificial Intelligence, Machine Learning, Web Development, UI/UX Design, and Automation. We create intelligent, scalable, and user-centric solutions that drive innovation, streamline operations, and enhance digital experiences. Our mission is to empower businesses and individuals with cutting-edge technology that transforms ideas into reality.")}
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Vision & Mission Section -->
  <section class="section bg-light dark:bg-darkmode-light text-text-dark dark:text-darkmode-text-dark">
    <div class="container text-center">
      <h2 class="h3 mb-6 text-primary dark:text-darkmode-primary">Our Vision & Mission</h2>
      <div class="row">
        <div class="md:col-6">
          <div class="p-6 shadow-lg rounded-lg bg-white dark:bg-darkmode-body transition-transform hover:scale-105">
            <h3 class="h5">ğŸŒ Our Vision</h3>
            <p class="text-text-light dark:text-darkmode-text-light">
              To redefine the future of technology by pioneering AI-driven,scalable, and intuitive digital solutions.  
              We envision a world where intelligent automation, cutting-edge software, and seamless user experiences  
              bridge the gap between innovation and real-world impact, driving progress across industries.
            </p>
          </div>
        </div>
        <div class="md:col-6">
          <div class="p-6 shadow-lg rounded-lg bg-white dark:bg-darkmode-body transition-transform hover:scale-105">
            <h3 class="h5">ğŸš€ Our Mission</h3>
            <p class="text-text-light dark:text-darkmode-text-light">
              To empower businesses and individuals with intelligent, efficient, and future-proof software solutions  
              that streamline processes, enhance productivity, and unlock new opportunities.  
              At FluxFloats, we are committed to delivering cutting-edge technology, fostering innovation,  
              and shaping a digital-first world where businesses can thrive and evolve effortlessly.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Animated Stats Section -->
  <section class="section bg-gradient-to-r from-primary to-secondary dark:from-darkmode-secondary dark:to-darkmode-primary text-white text-center">
    <div class="container">
      <h2 class="h3 mb-6 theme-text">Our Impact in Numbers</h2>
      <div class="row">
        {stats.map((stat, index) => (
          <div class="md:col-4">
            <h3 class="h2 counter theme-text" data-target={stat.target}>0</h3>
            <p class="text-lg">{stat.label}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Journey Section -->
  <section class="section bg-body dark:bg-darkmode-body">
    <div class="container">
      <h2 class="h3 text-center mb-6 text-primary dark:text-darkmode-primary">Our Journey</h2>
      <div class="timeline">
        {timelineItems.map((item, index) => (
          <div class="timeline-item">
            <span class="timeline-icon dark:theme-icon">{item.icon}</span>
            <div class="timeline-content">
              <h3>{item.year} - {item.title}</h3>
              <p set:html={item.description} />
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
</Base>

<style>
  .timeline {
    position: relative;
    max-width: 800px;
    margin: auto;
    padding: 20px 0;
  }
  .timeline-item {
    padding: 25px;
    position: relative;
    margin-bottom: 40px;
    background: var(--light);
    border-left: 4px solid var(--primary);
    transition: all 0.3s ease;
    border-radius: 0 8px 8px 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
  .dark .timeline-item {
    background: var(--darkmode-body);
    border-left: 4px solid var(--darkmode-primary);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  }
  .timeline-item:hover {
    transform: translateX(10px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  }
  .timeline-icon {
    position: absolute;
    left: -25px;
    top: 50%;
    transform: translateY(-50%);
    background: var(--primary);
    color: white;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
  }
  .dark .timeline-icon {
    background: var(--darkmode-primary);
  }
  .timeline-item:hover .timeline-icon {
    transform: translateY(-50%) scale(1.1);
  }
  .timeline-content {
    padding-left: 20px;
  }
  .timeline-content h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--primary);
    margin-bottom: 0.5rem;
  }
  .dark .timeline-content h3 {
    color: var(--darkmode-primary);
  }
  .timeline-content p {
    line-height: 1.6;
    margin: 0;
    color: var(--text-light);
  }
  .dark .timeline-content p {
    color: var(--darkmode-text-light);
  }
</style>

<script>
  function animateCounters() {
    const counters = document.querySelectorAll(".counter");

    counters.forEach(counter => {
      if (!(counter instanceof HTMLElement)) return;
      
      const target = parseInt(counter.getAttribute("data-target") || "0");
      let current = 0;
      const duration = 2000;
      const startTime = performance.now();

      function updateCounter() {
        const elapsed = performance.now() - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        current = Math.floor(progress * target);
        counter.textContent = `${current}+`;

        if (progress < 1) {
          requestAnimationFrame(updateCounter);
        } else {
          counter.textContent = `${target}+`;
        }
      }

      // Start animation immediately
      requestAnimationFrame(updateCounter);
    });
  }

  // Initialize counters immediately
  animateCounters();

  // Also initialize on page load
  document.addEventListener("DOMContentLoaded", animateCounters);

  // Handle client-side navigation
  document.addEventListener("astro:after-swap", () => {
    // Small delay to ensure DOM is ready
    setTimeout(animateCounters, 100);
  });

  // Reinitialize when page becomes visible
  document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === "visible") {
      animateCounters();
    }
  });

  // Watch for navigation events
  document.addEventListener("astro:page-load", () => {
    // Small delay to ensure DOM is ready
    setTimeout(animateCounters, 100);
  });

  // Watch for content changes
  const observer = new MutationObserver((mutations) => {
    for (const mutation of mutations) {
      if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
        // Check if counters exist in the new content
        const hasCounters = Array.from(mutation.addedNodes).some(node => 
          node instanceof Element && node.querySelector('.counter')
        );
        if (hasCounters) {
          setTimeout(animateCounters, 100);
          break;
        }
      }
    }
  });

  // Start observing the entire document
  observer.observe(document.body, {
    childList: true,
    subtree: true
  });
</script>
